1.确保已经准备好：

old_query.json

old_query.npy

正确的 API key（DASHSCOPE_API_KEY）

本地 Qwen 模型目录（QWEN_MODEL_DIR）

所有 Python 依赖安装完成

2.在项目目录下运行：

python user_to_index.py


3.按照终端提示操作：

输入一条自然语言指令，例如：

请输入自然语言指令：在高德地图上导航到公司


等待云端大模型返回多条格式化候选指令，类似：

候选句列表:
1. 打开高德地图 导航到公司
2. 使用高德地图 规划前往公司的路线
3. 在高德地图中 设置目的地为公司 并开始导航


根据提示选择其中一条作为最终格式化指令，例如输入：

请在以上候选中选择一条作为最终格式化指令（输入序号，从1开始）：2


4.脚本会：

对你选择的指令用 GTE 编码；

与历史任务库中的所有向量做余弦相似度；

打印 Top5 相似结果；

根据阈值筛选候选；

调用 Qwen3-8B 在这些候选中选出最终最相似的一条，并输出全局序号。

5.如果存在可复用任务，可能的输出示例：

Top5 相似度：
  排名1: 全局序号12, 相似度=0.8421, 指令=使用高德地图查找从当前位置到公司路线
  排名2: 全局序号35, 相似度=0.8012, 指令=打开高德地图导航到家
  ...

[步骤5] 超过阈值的候选指令：
  局部1 -> 全局12, 指令：使用高德地图查找从当前位置到公司路线
  局部2 -> 全局35, 指令：打开高德地图导航到家

[步骤6] 调用 Qwen3-8B 在这些候选中做最终判别 ...

========== 最终结果 ==========
最相似指令的全局序号（从1开始计）：12
对应历史指令：使用高德地图查找从当前位置到公司路线


6.若最高相似度 ≤ 阈值（例如 0.7），则会输出：

无可复用任务（最高相似度 <= 阈值）